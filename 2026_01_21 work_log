  1) 가상환경 활성화

  source /home/linuxuser/wemarketing/fastapi_test/airflow_env/bin/activate

  2) 잘못된 환경변수 제거 (2.x용 webserver 키)

  unset AIRFLOW__WEBSERVER__WEB_SERVER_PORT
  unset AIRFLOW__WEBSERVER__WEB_SERVER_HOST

  3) Airflow 3.x용 포트 설정 (API 서버가 UI 제공)

  export AIRFLOW__API__HOST=0.0.0.0
  export AIRFLOW__API__PORT=8081

  4) AIRFLOW_HOME 지정 (cfg/DB 경로 고정)

  export AIRFLOW_HOME=/home/linuxuser/wemarketing/fastapi_test/airflow

  5) (처음이거나 DB 문제 있으면) DB 초기화

  airflow db init

  6) 실행 (standalone이면 scheduler도 같이 뜸)

  airflow standalone

  7) 접속

  - http://localhost:8081

  ———

  문제 발생 시 체크 포인트

  - with DAG(...) 아래 코드 반드시 들여쓰기 (IndentationError 나면 scheduler가 죽음)
  - 변경 후에는 airflow 프로세스 재시작 필요 (서버 reboot 불필요)

  ———

db 리셋 방법
airflow db reset -y


스케줄러 상태 확인
airflow jobs check --job-type SchedulerJob --local


# 문제점
ui 와 api-server의 포트가 맞지 않았음.
Tasks는 8080에서 실행시켜야할 부분을 찾고 있었음.

export AIRFLOW__API__BASE_URL="http://localhost:8081"
export AIRFLOW__CORE__EXECUTION_API_SERVER_URL="http://localhost:8081/execution"
( --> 이 부분이 제일 수정하기 힘들었음. )

로 써주면 강제로 8081로 설정하게 됨.

+ airflow,cfg 들어가서 기본 포트정보 수정 + load_example => False로 두기
