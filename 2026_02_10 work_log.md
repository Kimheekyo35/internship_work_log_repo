# 2026_02_10 WORK_LOG

## 오늘 배운 점

### 1. 팝업 URL에서 pdf 받아옴
* 해당 URL 자체가 PDF인지 확인
* `resp = popup.request.get(url)` 로 playwright의 request를 사용함 **(로그인 세션, 쿠키, 인증헤더)** 포함됨

```
ct = resp.headers.get("content-type")
if "application/pdf" in ct:

맞으면
out.write_bytes(resp.body())
로 다운로드
```
* 만약 위 단계에서 pdf를 찾지 못한다면
```
popup.wait_for_response(is_pdf_response)
👉 popup이 로딩하면서 발생하는 모든 네트워크 응답을 감시
content-type = application/pdf
```
**해당 구조**를 쓴 이유
```
iframe 찾기
shadow-root 뚫기
blob 잡기
```

### 2. 물류팀 문제점
1. adobe api를 쓰면 한달에 500건밖에 되지 않음
2. 기존 pdf가 이미지 + 텍스트라 해당 형태 그대로 excel화 하기 힘듦
3. 만약 pdf -> 이미지 -> 엑셀 하면 툴만 엑셀을 사용한 이미지일뿐

👉 물류팀에서 sheet마다 양식을 설정해두어서 함부로 바꾸기 힘듦.
<img width="1294" height="314" alt="스크린샷 2026-02-11 111045" src="https://github.com/user-attachments/assets/8a9c5825-86cc-4c45-9b50-6e81f38583b7" />
이 양식에 맞추어 기존 `pdfplumber` , `fitz` 를 사용하여 수정할 수 있을 듯.

`참고: pdf_to_excel.py , pdf_to_text.py`

👉 송장번호 : 전체가 다 출력되지 않는 문제점(대기시간이 충분하지 않아서..?) arrange shipment 에서 대기시간 필요 or 5 of 5 위 아래가 같아야 함
